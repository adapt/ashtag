{% extends "core/jqm-page.html" %}

{% load manifesto %}
{% block manifest %}manifest="{% manifest_url %}"{% endblock %}
{% block title %}Submit a Sighting{% endblock %}
{% block class %}submit-sighting-page{% endblock %}
{% block id %}submit-sighting-page{% endblock %}

{% block page %}
            
    <div data-role="content" class="at-content" role="main">
        <form class="form submit-sighting-form ui-shadow" action="{% url 'sightings:submit' %}" method="post" data-ajax="false" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-intro">
                <p>
                    Need help tagging a tree for the first time? 
                    <a href="{% url 'public:tagging-video' %}">Watch our video</a> for a step-by-step guide.
                </p>
            </div>
            {% if not request.user.is_authenticated %}
            <div class="form-row">
                <label for="email" class="ui-input-text">Email Address</label>
                <input class="email" type="email"
                    name="creator_email" id="id_creator_email"
                    value="{{ form.creator_email.value }}" placeholder="Enter your email"
                    required aria-required="true" />
            </div><!--//form-row-->
            {% endif %}
            <div class="form-row{% if form.errors.tag_number %} errors{% endif %}">
                {{ form.errors.tag_number }}
                <label for="id_tag_number">Tag Number (if present)</label>
                <input class="tag-number" type="text" name="tag_number"
                pattern="[\d]{5}"
                title="Tag numbers are five digits"
                x-moz-errormessage="Tag numbers are five digits"
                id="id_tag_number" placeholder="eg. 12345" value="{{ form.tag_number.value }}" />
            </div><!--//form-row-->
            <div class="form-row{% if form.errors.image %} errors{% endif %}">
                {{ form.errors.image }}
                <label for="id_image">Select a photo</label>
                <input id="id_image" type="file" name="image" single 
                    required aria-required="true" />
                <span class="help-text">Need help identifying ash tress? See our <a href="{% url 'public:guide' %}">identification guide</a>.</span>
            </div><!--//form-row-->
            
            <div class="form-row{% if form.errors.location %} errors{% endif %}">
                {{ form.errors.location }}
                <label for="id_location" class="ui-input-text">Tree location</label>
                <span class="help-text">Drag the pin (or click elsewhere) to move the location.
                The more accurately you position the pin, the easier it will be for others to find the tree again later.</span>
                <div class="map-wrapper">
                    <div id="map_canvas" class="map"></div>
                    <div class="offline-msg">Map not available when offline</div>
                </div>
                <input type="hidden" name="location" id="id_location" value="{{ form.location.value }}" />
            </div>
            
            <div class="form-row{% if form.errors.disease_state %} errors{% endif %}">
            <fieldset data-role="controlgroup">
                {{ form.errors.disease_state }}
                <legend>In your opinion, how likely is this tree to have Ash Dieback Disease?</legend>
                <input type="radio" name="disease_state"
                id="id_disease_state_1" value=""
                {% if form.disease_state.value == "" or form.disease_state.value == None %}checked="checked"{% endif %} />
                    <label for="id_disease_state_1">Uncertain / I don't know</label>
        
                    <input type="radio" name="disease_state"
                    id="id_disease_state_2" value="True"
                    {% if form.disease_state.value == 'True' %}checked="checked"{% endif %}
                    />
                    <label for="id_disease_state_2">Likely</label>
        
                    <input type="radio" name="disease_state"
                    id="id_disease_state_3" value="False"
                    {% if form.disease_state.value == 'False' %}checked="checked"{% endif %}
                    />
                    <label for="id_disease_state_3">Unlikely</label>
            </fieldset>
            </div><!--//form-row-->
            <div class="form-row">
            <label for="id_notes">Leave a comment</label>
            <textarea cols="40" rows="8" name="notes" id="id_notes">{{ form.notes.value }}</textarea>
            </div><!--//form-row-->

            <div class="cta-btn-wrapper">
                <input class="button submit-sighting" type="submit" value="Submit" name="submit-sighting" />
                <div class="saved-for-later" style="display: none;"><span class="total">1</span> sighting(s) will be uploaded when you are back online</div>
            </div>
            
            <div class="submit-done-msgs" style="display: none;">
                <div class="online-msg">
                    <p class="loading-msg"><strong>Uploading sighting, please wait...</strong></p>
                    <p class="ajax-spinner"></p>
                </div>
                <div class="offline-msg">
                    <p><strong>Saved for later</strong></p>
                    <p>Come back here once you are online and your sighting will be uploaded automatically</p>
                </div>
        </div>
        </form><!--//submit-sighting-form-->                          
   
    </div><!--//at-content-->  

{% endblock page %}


