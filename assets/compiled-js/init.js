// Generated by CoffeeScript 1.7.1
(function() {
  window._gaq = window._gaq || [];

  jQuery(function() {
    var $, goOffline, goOnline;
    $ = jQuery;
    $.ajaxSetup({
      cache: false
    });
    goOnline = (function(_this) {
      return function() {
        return $('body').addClass('online').removeClass('offline');
      };
    })(this);
    goOffline = (function(_this) {
      return function() {
        return $('body').addClass('offline').removeClass('online');
      };
    })(this);
    $(window).on('online', goOnline);
    $(window).on('offline', goOffline);
    if (ashtag.extra.online) {
      goOnline();
    } else {
      goOffline();
    }
    if (window.applicationCache) {
      applicationCache.addEventListener('updateready', (function(_this) {
        return function() {
          return $('#updatesready').show();
        };
      })(this));
    }
    return $.ajax({
      url: '/session-status/',
      type: 'get',
      dataType: 'json'
    }).then(function(data) {
      return $('body').toggleClass('authenticated', data.authenticated).toggleClass('anonymous', !data.authenticated).toggleClass('ios', data.phonegap).toggleClass('non-ios', !data.phonegap);
    });
  });

  $(window).on('pagechange', (function(_this) {
    return function(event, obj) {
      var currentUrl;
      currentUrl = $.mobile.activePage.data('url');
      if (obj.toPage.attr('id') === 'login-page') {
        $('.login-page label[for=id_username]').text('Email');
      }
      $('form').each(function(i, el) {
        var $el;
        $el = $(el);
        if (!$el.attr('action')) {
          return $el.attr('action', currentUrl);
        }
      });
      return window._gaq.push(['_trackPageview', currentUrl]);
    };
  })(this));

}).call(this);
